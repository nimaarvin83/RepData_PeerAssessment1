---
title: "Reproducible Research: Peer Assessment 1"
output: html_document
keep_md: true
runtime: knitr
---
## Author : Nima Arvin

### setting the global options to show the code and results for all code chunks
```{r}
knitr::opts_chunk$set(echo = TRUE)
```

### Code for reading in the dataset and/or processing the data

```{r Loading the data , cache=TRUE}
library(knitr)
wd <- getwd()
zipfile <-download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip",destfile=paste0(wd,"/file.zip")) 
unzip(paste0(wd,"/file.zip"))
maindata <- read.csv(paste0(wd,"/activity.csv"), header = TRUE)
summary(maindata)
str(maindata)
### Count of NA values in steps
sum(is.na(maindata$steps))

```


# Daily Activity Pattern

## Mean, Total and Median of number of steps taken daily

### What is mean total number of steps taken per day?
```{r}
library(dplyr)
gdata <- group_by(maindata, date)
dailymeans<- summarise(gdata, mean=mean(steps, na.rm = TRUE))
dailymeans
```

### Median number of steps taken each day
```{r}
dailymedians<- summarise(gdata, mean=median(steps, na.rm = TRUE))
dailymedians
```


### Histogram of the total number of steps taken each day
```{r}
dailytotals <- summarise(gdata, totals=sum(steps, na.rm = TRUE))
dailytotals
with(dailytotals,hist(totals))
```


## What is the average daily activity pattern?
### Time series plot of the average number of steps taken
```{r}
library(ggplot2)
g <- ggplot(dailymeans, aes(date,mean, group=1))
g + geom_point()+ geom_line()+geom_smooth(method = "glm", na.rm = TRUE)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+labs(title="Average Steps Per Day",xlab="Observation Date",ylab="Mean of number of steps" )
```

### Are there differences in activity patterns between weekdays and weekends?


### Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends


### The 5-minute interval that, on average, contains the maximum number of steps



## Imputing missing values
### Code to describe and show a strategy for imputing missing data




### Histogram of the total number of steps taken each day after missing values are imputed







### All of the R code needed to reproduce the results (numbers, plots, etc.) in the report
